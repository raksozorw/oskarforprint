(this["webpackJsonpstripe-react"]=this["webpackJsonpstripe-react"]||[]).push([[0],{45:function(e,t,a){e.exports=a(76)},73:function(e,t,a){},76:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(40),c=a.n(l),u=a(12),i=a.n(u),o=a(18),s=a(2),m=a(26),d=a(42),p=Object(n.createContext)(null);function E(e){var t=e.children,a=Object(n.useState)([]),l=Object(s.a)(a,2),c=l[0],u=l[1],i=Object(n.useState)(0),o=Object(s.a)(i,2),E=o[0],b=o[1],v=Object(n.useState)(null),g=Object(s.a)(v,2),h=g[0],f=g[1];return r.a.createElement(p.Provider,{value:{items:function(e){return e.reduce((function(e,t){var a=e.find((function(e){return e.sku===t.sku}));return a?a.quantity=a.quantity+1:e.push(Object(m.a)({quantity:1},t)),e}),[])}(c),addToCart:function(e){var t=E+1;u((function(t){return[].concat(Object(d.a)(t),[e])})),b(t)},removeItem:function(e){var t=E-1,a=c.filter((function(t,a){return a!==e}));u(a),b(t)},count:E,setCustomer:f,customer:h}},t)}var b=a(20),v=a.n(b),g=a(93),h=a(95),f=Object(g.a)((function(e){return{root:{display:"flex","& > * + *":{marginLeft:e.spacing(2)}}}}));function j(){var e=f();return r.a.createElement("div",{className:e.root},r.a.createElement(h.a,null))}function O(){var e=Object(n.useContext)(p),t=Object(n.useState)(""),a=Object(s.a)(t,2),l=a[0],c=a[1],u=Object(n.useState)(""),i=Object(s.a)(u,2),o=i[0],m=i[1],d=Object(n.useState)(""),E=Object(s.a)(d,2),b=E[0],v=E[1],g=Object(n.useState)(""),h=Object(s.a)(g,2),f=h[0],j=h[1],O=Object(n.useState)(""),C=Object(s.a)(O,2),y=C[0],k=C[1],S=Object(n.useState)(""),x=Object(s.a)(S,2),N=x[0],w=x[1],A=Object(n.useState)(""),I=Object(s.a)(A,2),T=I[0],q=I[1],z=Object(n.useState)(""),B=Object(s.a)(z,2),P=B[0],H=B[1],J=Object(n.useState)(!0),R=Object(s.a)(J,2),L=R[0],Y=R[1],_=Object(n.useState)(!1),F=Object(s.a)(_,2),W=F[0],D=F[1],K=function(e,t){switch(t){case"name":c(e.target.value);break;case"email":m(e.target.value);break;case"billingAddress":v(e.target.value);break;case"billingCode":k(e.target.value);break;case"billingCity":j(e.target.value);break;case"shippingAddress":w(e.target.value);break;case"shippingCity":q(e.target.value);case"shippingCode":H(e.target.value)}};return r.a.createElement("form",{className:"customer-form"},r.a.createElement("div",null,r.a.createElement("h2",null,"Contact"),r.a.createElement("label",null,"Name"),r.a.createElement("input",{type:"text",onChange:function(e){return K(e,"name")},value:l}),r.a.createElement("label",null,"Email"),r.a.createElement("input",{type:"text",onChange:function(e){return K(e,"email")},value:o})),r.a.createElement("div",null,r.a.createElement("h2",null,"Billing Address"),r.a.createElement("label",null,"Address"),r.a.createElement("input",{type:"text",onChange:function(e){return K(e,"billingAddress")},value:b}),r.a.createElement("label",null,"City"),r.a.createElement("input",{type:"text",onChange:function(e){return K(e,"billingCity")},value:f}),r.a.createElement("label",null,"Post Code"),r.a.createElement("input",{type:"text",onChange:function(e){return K(e,"billingCode")},value:y})),r.a.createElement("div",null,r.a.createElement("h3",null,"Shipping same as billing?"),r.a.createElement("input",{type:"checkbox",onChange:function(){Y(!0!==L)},checked:L})),!L&&r.a.createElement("div",null,r.a.createElement("h2",null,"Shipping Address"),r.a.createElement("label",null,"Address"),r.a.createElement("input",{type:"text",onChange:function(e){return K(e,"shippingAddress")},value:N}),r.a.createElement("label",null,"City"),r.a.createElement("input",{type:"text",onChange:function(e){return K(e,"shippingCity")},value:T}),r.a.createElement("label",null,"Post Code"),r.a.createElement("input",{type:"text",onChange:function(e){return K(e,"shippingCode")},value:P})),r.a.createElement("button",{onClick:function(t){t.preventDefault(),D(!0),e.setCustomer({name:l,email:o,billingAddress:b,billingCity:f,billingCode:y,shippingAddress:N,shippingCity:T,shippingCode:P}),console.log(e.customer)},disabled:W},W?"Confirmed!":"Confirm"))}function C(e){return"\xa3".concat((.01*e).toFixed(2))}function y(e){var t=e.stripeToken,a=Object(n.useState)(null),l=Object(s.a)(a,2),c=l[0],u=l[1],m=Object(n.useState)(null),d=Object(s.a)(m,2),E=d[0],b=d[1],g=Object(n.useState)(""),h=Object(s.a)(g,2),f=h[0],j=h[1],y=Object(n.useContext)(p);Object(n.useEffect)((function(){window.Stripe&&u(window.Stripe(t))}),[t]);var k=function(){var e=Object(o.a)(i.a.mark((function e(){var t,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return b("spin"),e.next=3,v.a.post("http://localhost:8888/create-checkout-session",{data:{items:y.items,customer:y.customer}});case 3:return t=e.sent,e.next=6,c.redirectToCheckout({sessionId:t.data.id});case 6:(a=e.sent).error&&(console.log(a.error.message),j(a.error.message),b("error"));case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return r.a.createElement("div",{className:"cart-and-checkout-button"},r.a.createElement("div",{className:"cart"},r.a.createElement("table",null,r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Item"),r.a.createElement("th",null,"Size"),r.a.createElement("th",null,"Quantity"),r.a.createElement("th",null,"Price"))),r.a.createElement("tbody",null,y.items.map((function(e,t){return r.a.createElement("tr",null,r.a.createElement("td",null,e.name),r.a.createElement("td",null,"50x70cm"),r.a.createElement("td",null,e.quantity),r.a.createElement("td",null,C(e.price)),r.a.createElement("td",null,r.a.createElement("button",{onClick:function(){return y.removeItem(t)}},"X")))})),r.a.createElement("tr",null,r.a.createElement("td",{colSpan:3},"Total:"),r.a.createElement("td",null,C(y.items.reduce((function(e,t){return e+t.quantity*t.price}),0)))))),r.a.createElement("div",null,r.a.createElement(O,null),r.a.createElement("div",null,y.items.length>0&&null!==y.customer&&r.a.createElement("div",null,r.a.createElement("div",{className:"stripe-button"},null===E&&r.a.createElement("button",{onClick:k},"Checkout With Stripe"),"spin"===E&&r.a.createElement("button",null,"Loading ... "),"error"===E&&r.a.createElement("div",null,r.a.createElement("button",{onClick:k},"Checkout With Stripe"),r.a.createElement("p",{style:{color:"red"}},f))))))))}var k=a(41),S=a.n(k);function x(){var e=Object(n.useContext)(p);return r.a.createElement("nav",null,r.a.createElement("div",{className:"nav-div"},r.a.createElement("div",{className:"nav-title"},r.a.createElement("h1",null,"OSKAR FOR PRINT")),r.a.createElement("a",{href:"#cart"},r.a.createElement("div",{className:"cart-icon"},r.a.createElement("div",{className:"cart-count"},r.a.createElement(S.a,{fontSize:"medium"})," ",r.a.createElement("div",null,e.count))))))}function N(e){var t,a=Object(n.useState)(!1),l=Object(s.a)(a,2),c=l[0],u=l[1],i=Object(n.useContext)(p);return r.a.createElement("div",{className:"print"},r.a.createElement("div",{className:"print-box"},r.a.createElement("img",{src:e.product.img,alt:e.product.name,onLoad:function(){console.log("loaded"),u(!0)},style:c?{opacity:"1",display:"inline-block",backgroundImage:"linear-gradient( to right, rgba(255, 96, 96, 0), rgba(0, 17, 255,0))"}:{opacity:"0",display:"none",backgroundImage:"linear-gradient( to right, rgba(255, 96, 96, 0), rgba(0, 17, 255,0))"}}),!c&&r.a.createElement(j,null)),r.a.createElement("h2",null,e.product.name),r.a.createElement("h3",null,(t=e.product.price,"\xa3".concat((.01*t).toFixed(2)))),r.a.createElement("div",null,r.a.createElement("button",{onClick:function(){i.addToCart(e.product)}},"Add to Cart")))}var w=a(96);a(73);var A=a(8),I=Object(A.a)();c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(E,null,r.a.createElement(w.b,{history:I},r.a.createElement(w.c,null,r.a.createElement(w.a,{path:"/",exact:!0,component:function(){var e=Object(n.useState)([]),t=Object(s.a)(e,2),a=t[0],l=t[1],c=function(){var e=Object(o.a)(i.a.mark((function e(){var t,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.a.post("http://localhost:8888/productList");case 2:t=e.sent,console.log(t.data),console.log(t.data),a=t.data.products.data.reduce((function(e,a,n){var r=t.data.prices.data.reduce((function(e,t){return e.push({sku:t.id,price:t.unit_amount_decimal}),e}),[]);return e.push(Object(m.a)({name:a.name,img:a.images[0]},r[n])),e}),[]),console.log(a),l(a);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(n.useEffect)((function(){c()}),[]),r.a.createElement("div",{className:"all-prints"},0===a.length&&r.a.createElement("div",{className:"loading"},r.a.createElement(j,null)),a.length>0&&r.a.createElement("div",null,r.a.createElement(x,null),r.a.createElement("div",{className:"prints"},a.map((function(e){return r.a.createElement(N,{product:e})}))),r.a.createElement("div",{id:"cart"}),r.a.createElement(y,{stripeToken:"pk_live_51HUrfvBzBdhEW71Sa8jN89KrJapvljYfHjzH6HVzm44CsYzkcRRcJH3nku5B5CgSBCfbtI1ZrlaJ3t6Sa90tvewq00gn0lN6YD"})))}}),r.a.createElement(w.a,{path:"/success",exact:!0,component:function(){return r.a.createElement("div",null,r.a.createElement("h2",null,"Thanks for your order!"),r.a.createElement("h2",null,"Your delivery is on its way."))}}),r.a.createElement(w.a,{path:"/fail",exact:!0,component:function(){return r.a.createElement("div",null,r.a.createElement("h2",null,"There was a problem with your order. Please try again, or contact us if you require assistance."))}}))))),document.getElementById("root"))}},[[45,1,2]]]);
//# sourceMappingURL=main.bb475e74.chunk.js.map